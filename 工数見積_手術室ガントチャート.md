# 工数見積書：手術室ガントチャート生成ツール

## 前提条件

| 項目 | 内容 |
|------|------|
| 担当者 | 中級Pythonプログラマ（実務経験2〜4年程度） |
| スキル想定 | pandas/openpyxlの基本経験あり、Excel帳票開発は初〜中程度 |
| AI支援 | なし（ドキュメント・Web検索のみ） |
| 1人日 | 6.5時間 |

---

## 工程別工数

### Phase 1：要件定義・仕様策定（2.0人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| 現場ヒアリング（手術室運用の理解） | 0.5日 | 入室〜麻酔終了の意味、部屋名規則、曜日運用等 |
| 入力データ仕様の確認・整理 | 0.25日 | Excelカラム定義、時刻フォーマット、欠損値の扱い |
| 出力仕様の策定 | 0.5日 | 時間軸の範囲、10分刻み、部屋の表示順、色分けルール |
| 稼働率計算ロジックの定義 | 0.25日 | 平日9-17時/土曜9-13時、9室換算（01A・01Bは各0.5室、アンギオ除外） |
| 仕様書ドキュメント作成 | 0.5日 | 要件定義書として文書化 |

### Phase 2：Excelテンプレート設計（1.5人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| レイアウト設計（列構成の決定） | 0.5日 | 列B=日付、列C=部屋名、列D以降=10分刻み時間軸 |
| 罫線・セル結合・書式ルールの設計 | 0.5日 | 時間ヘッダ結合、日付セル縦結合、最下行罫線等 |
| 手動でExcelプロトタイプ作成 | 0.5日 | 1日分のサンプルを手作業で作り、見た目を確認 |

### Phase 3：コーディング（5.25人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| データ読込・前処理 | 0.5日 | pandas読込、日付パース、時刻型の統一処理 |
| 時刻→列番号変換ロジック | 0.5日 | time/timedelta/str各型への対応、範囲外クリップ |
| ガントバー描画（塗りつぶし＋ラベル） | 1.5日 | セル単位の塗り、ラベル配置、色分け（定時/緊急） |
| 罫線・書式制御 | 1.0日 | openpyxlの罫線制御は試行錯誤が多い（最難関部分） |
| 稼働率計算（平日/土曜分岐、室数重み付け） | 0.5日 | 9室換算（01A/01B=0.5室、アンギオ除外）、クリッピング計算 |
| ヘッダ・凡例・印刷設定 | 0.25日 | タイトル、凡例行、A3横向き等 |
| 全日付ループ・ファイル出力 | 0.25日 | 日付ごとにブロック生成、保存 |

> **コーディングの難所：** openpyxlでの罫線制御は、セル結合・塗りつぶしとの競合で罫線が消える問題への対処に時間がかかる。中級者でも1日程度を要する典型的なハマりポイント。

### Phase 4：テスト・デバッグ（3.0人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| 1日分のデータで目視確認 | 0.5日 | 9/1のデータで手動照合 |
| 全日分の通し実行・目視検証 | 0.5日 | 24日分の出力を1日ずつ確認 |
| エッジケース対応 | 1.0日 | 手術0件の部屋、日をまたぐ手術、22:00超え、データ欠損 |
| 罫線・書式の微調整 | 0.5日 | Excel上で開いて罫線抜け・色ずれ等を修正 |
| 修正→再テストの繰り返し | 0.5日 | 指摘事項の修正と再確認サイクル |

### Phase 5：アウトプット調整・ユーザーレビュー（2.5人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| 現場担当者への初回レビュー | 0.5日 | サンプル出力を見せてフィードバック取得 |
| フィードバック反映①（色変更、土曜計算変更等） | 0.5日 | 「色を水色/ピンクに」「土曜は4h」等 |
| フィードバック反映②（稼働率の室数換算変更） | 0.5日 | 「アンギオ除外」「01A/01Bは0.5室」等の業務ロジック変更 |
| フィードバック反映③（表体裁修正） | 0.25日 | 「22:00列追加」「最下行罫線」等 |
| 修正後の再テスト | 0.5日 | 各修正後の全日分再検証 |
| 最終確認 | 0.25日 | 修正後の再レビュー |

> **実態：** 今回の開発で実際に4回のフィードバック・修正サイクルが発生しました。
> 外注開発では、レビューのたびに日程調整・修正依頼・再納品のリードタイムが加わるため、
> カレンダー上の所要期間はさらに伸びます。

### Phase 6：ドキュメント・マニュアル作成（1.5人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| 利用者向け操作マニュアル | 0.5日 | 実行手順、入力ファイルの仕様、トラブルシューティング |
| コード内コメント・README整備 | 0.25日 | 設定値の変更方法等 |
| 環境構築手順書 | 0.25日 | Python/pip/ライブラリのインストール手順 |
| 引き継ぎ資料（設計メモ） | 0.5日 | 列マッピング、時刻変換ロジック等の技術ドキュメント |

### Phase 7：環境整備・納品（0.5人日）

| 作業内容 | 工数 | 備考 |
|----------|------|------|
| 実行環境の構築・動作確認 | 0.25日 | ユーザーPCでの動作確認 |
| 納品・引き渡し | 0.25日 | フォルダ構成整理、最終納品 |

---

## 工数サマリ

| 工程 | 工数（人日） |
|------|-------------|
| Phase 1：要件定義・仕様策定 | 2.0 |
| Phase 2：Excelテンプレート設計 | 1.5 |
| Phase 3：コーディング | 5.25 |
| Phase 4：テスト・デバッグ | 3.0 |
| Phase 5：アウトプット調整・レビュー | 2.5 |
| Phase 6：ドキュメント・マニュアル | 1.5 |
| Phase 7：環境整備・納品 | 0.5 |
| **合計** | **16.25人日（約105.6時間 ≒ 約3〜4週間）** |

---

## 補足

### リスクバッファ
上記は順調に進んだ場合の見積もりです。実務では以下のリスクを考慮し、**+20〜30%のバッファ（3〜5人日）** を見込む。

- openpyxlの罫線・結合セルの挙動に起因する想定外の不具合
- 入力データの品質問題（時刻の表記揺れ、手術室名の不一致等）
- ユーザーレビューでの追加要望（色変更、集計条件変更等が複数回発生）

### バッファ込み合計
**16〜21人日（104〜137時間 ≒ 3〜5週間）**

---

## 外注費用見積（国内ITソリューション会社に発注した場合）

### 単価算定の考え方

受注企業がエンジニアをアサインする際の請求単価は、エンジニアの給与だけでなく、
企業として事業を維持するための経費構造を反映する必要。

#### 受注企業側のコスト構造

| 項目 | 売上に対する比率 | 内容 |
|------|-----------------|------|
| エンジニア人件費（給与・社保・賞与） | 40〜50% | 額面給与の約1.3〜1.5倍が実コスト |
| 会社経費（販管費） | 30〜40% | オフィス賃料、PC・開発環境、光熱費、通信費、管理部門人件費、研修費、福利厚生等 |
| 営業・受注経費 | 5〜10% | 提案書作成、見積作業、営業人件費、交通費等 |
| 利益 | 10〜15% | 企業として維持すべき適正利益 |

→ つまり、エンジニアの給与が月40万円でも、請求単価は**その2.5〜3倍**が必要。

#### エンジニア稼働率の影響

| 項目 | 値 | 備考 |
|------|-----|------|
| 年間営業日 | 約245日 | 土日祝除く |
| 受注稼働率 | 80% | 待機・社内業務・研修・営業支援等で20%は非稼働 |
| 実稼働日数 | 約196日/年 | 245日 × 0.8 |
| 月あたり実稼働 | 約16.3日 | 196日 ÷ 12ヶ月 |

→ 月20.5営業日あっても、売上に繋がるのは約16日。非稼働分のコストも請求単価に織り込む必要がある。

### 請求単価の算定

| 役割 | 想定年収 | 企業実コスト（×1.4） | 会社経費加算（売上比40%） | 月額請求単価（税別） | 人日単価（÷16.3日） |
|------|---------|---------------------|------------------------|--------------------|--------------------|
| PM／SE | 650万円 | 910万円 | +607万円 | **約126万円/月** | **約7.7万円/日** |
| 中級PG | 500万円 | 700万円 | +467万円 | **約97万円/月** | **約6.0万円/日** |

※会社経費は売上の40%として算出（売上 = 人件費実コスト ÷ 0.6）
※首都圏の中堅ITソリューション会社（社員50〜300名規模）を想定

### 受注にかかる諸経費（案件単位）

| 項目 | 金額（税別） | 備考 |
|------|-------------|------|
| 営業・提案・見積作成費 | 10万円 | 営業担当を使わない場合でも最低限の提案・契約事務 |
| 契約事務・検収対応 | 3万円 | 契約書作成、NDA、検収手続き |
| **受注諸経費 小計** | **13万円** | |

### 工程別費用内訳

| 工程 | 担当 | 工数（人日） | 人日単価 | 小計（税別） |
|------|------|-------------|---------|-------------|
| Phase 1：要件定義・仕様策定 | PM/SE | 2.0日 | @7.7万円 | 15.4万円 |
| Phase 2：Excelテンプレート設計 | PM/SE + PG | 1.5日 | @7.7万円 | 11.6万円 |
| Phase 3：コーディング | PG | 5.25日 | @6.0万円 | 31.5万円 |
| Phase 4：テスト・デバッグ | PG | 3.0日 | @6.0万円 | 18.0万円 |
| Phase 5：アウトプット調整・レビュー | PM/SE + PG | 2.5日 | @6.8万円 | 17.0万円 |
| Phase 6：ドキュメント・マニュアル | PG | 1.5日 | @6.0万円 | 9.0万円 |
| Phase 7：環境整備・納品 | PG | 0.5日 | @6.0万円 | 3.0万円 |
| **開発工数 小計** | | **16.25日** | | **105.5万円** |

### 費用総括

| 項目 | 金額（税別） |
|------|-------------|
| 開発費（工数ベース） | 105.5万円 |
| 受注諸経費（営業・契約） | 13.0万円 |
| リスクバッファ（20%） | 21.1万円 |
| **見積合計（税別）** | **約140万円** |
| 消費税（10%） | 14.0万円 |
| **見積合計（税込）** | **約154万円** |

### 想定価格レンジ

| ケース | 金額（税込） | 条件 |
|--------|-------------|------|
| 最低ライン | 約120万円 | 仕様確定済み、修正1回以内、マニュアル簡易版 |
| **標準** | **約150〜160万円** | **本見積の想定ケース（仕様変更2〜3回を含む）** |
| 上振れ | 約190〜220万円 | 仕様変更多数、追加帳票、手厚いドキュメント・保守引継ぎ |

> **補足：** 大手SIerや医療系に強い専門ベンダーに発注した場合、
> 業界知識プレミアムや品質管理体制の厚さから、上記の1.3〜1.5倍
> （税込200〜250万円程度）になる。

---

> **注目すべき点：** 外注開発では仕様変更のたびに追加見積・修正・再テスト・再納品のサイクル必要。
実際には上振れし、大幅なコスト増となる。